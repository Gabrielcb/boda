
CUCL_DEVICE float det_hash_rand( uint32_t const rv ) {
  uint32_t h = rv;
  h ^= h >> 16;
  h *= 0x85ebca6b;
  h ^= h >> 13;
  h *= 0xc2b2ae35;
  h ^= h >> 16;
  return (float)( h ) * ( 10.0f / (float)( U32_MAX ) ) - 5.0f;
}

CUCL_GLOBAL_KERNEL void %(rtc_func_name)( GASQ float * const filts ) // CUCL OUT out_chan_blk:in_chan:y:x:out_chan_reg:out_chan_tile
{
  // CUCL IX GLOB_ID_1D filts
  if( GLOB_ID_1D >= %(filts_dims_prod) ) { return; }
  float val = %(vi); 
  if( %(mode) == 2 ) { val += %(GLOB_ID_1D_x); }
  if( %(mode) == 3 ) { val += %(GLOB_ID_1D_y); }
  else if( %(mode) == 4 ) { 
    if( (%(GLOB_ID_1D_x)==%(filts_x_dim)/2) && (%(GLOB_ID_1D_y)==%(filts_y_dim)/2) ) { val += 1.0f; }
  } else if( %(mode) == 5 ) {
    val += det_hash_rand( GLOB_ID_1D + 8753985 );
  }
  filts[GLOB_ID_1D] = val;
}
